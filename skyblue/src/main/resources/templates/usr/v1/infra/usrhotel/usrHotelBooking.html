<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Rentkit - Directory & Listings Bootstrap 5 Template.">

  	<link rel="apple-touch-icon" sizes="180x180" href="/usr/v1/template/booking_page/docs/assets/images/apple-touch-icon.png">
  	<link rel="icon" type="image/png" sizes="32x32" href="/usr/v1/template/booking_page/docs/assets/images/icon-32x32.png">
  	<link rel="icon" type="image/png" sizes="16x16" href="/usr/v1/template/booking_page/docs/assets/images/icon-16x16.png">

  <!-- Libs CSS -->
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/magnific-popup/dist/magnific-popup.css" rel="stylesheet" />
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/animate.css/animate.min.css" rel="stylesheet">
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/nouislider/dist/nouislider.min.css" rel="stylesheet">
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/uppy/dist/uppy.min.css" rel="stylesheet">
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/litepicker/dist/css/litepicker.css" rel="stylesheet">
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/simplebar/dist/simplebar.min.css" rel="stylesheet">
  <link href="/usr/v1/template/booking_page/rentkit-html/assets/libs/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
  <link href="/usr/v1/css/commonUsr.css" rel="stylesheet">
	
  <!-- Theme CSS -->
  <link rel="stylesheet" href="/usr/v1/template/booking_page/rentkit-html/assets/css/theme.min.css">
  
  <title>Reservation</title>

</head>

<body>
  <!-- main wrapper -->
  <div class="main-wrapper">
  	<!-- ======= header ======= -->
    <div class="nav-header nav-header-classic shadow">
    	<div th:replace="~{usr/v1/infra/common/header :: div}"></div>
    </div>
    <!-- End header -->
    <!-- content -->
    <div class="py-11 py-7">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-lg-8 col-md-12 col-12">
            <div class="card checkout-form">
              <div class="card-body p-5">
                <h4 class="mb-4 border-bottom pb-2">예약 세부정보</h4>
                <!-- form -->
                <form name="form" method="post" action="/v1/infra/usrhotel/bookingUpdt">
                  <!-- row 1 start -->
                  <div class="row">
	                  <div class="mb-3 col-md-6">
	                    <label for="fname" class="form-label">이름
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="customerName" name="customerName"
	                    	th:value="${bookingItem?.customerName}" readonly>
	                  </div>
	                  <div class="mb-3 col-md-6">
	                    <label for="email" class="form-label">생년월일
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="birthDate" name="birthDate"
	                    	th:value="${#dates.format(bookingItem?.birthDate, 'yyyy-MM-dd')}" readonly>
	                  </div>
                  </div>
                  <!-- row 1 end -->
                  <!-- row 2 start -->
                  <div class="row">
	                  <div class="mb-3 col-md-6">
	                    <label for="confirm-email" class="form-label">전화번호
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="phoneNumber" name="phoneNumber"
	                    	th:value="${bookingItem?.phoneNumber}" readonly>
	                  </div>
	                  <div class="mb-3 col-md-6">
	                    <label for="confirm-email" class="form-label">이메일
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="email" name="email"
	                    	th:value="${bookingItem?.email}" readonly>
	                  </div>
                  </div>
                  <!-- row 2 end -->
                  <!-- row 3 start -->
                  <div class="row">
	                  <div class="mb-3 col-md-12">
	                    <label for="message" class="form-label">요청사항
<!-- 	                    	<span class="text-danger">*</span> -->
	                    </label>
	                    <textarea class="form-control" rows="3" id="bkDesc"
	                    	th:text="${bookingItem?.bkDesc}" placeholder="요청사항을 작성하세요">
	                    </textarea>
	                  </div>
	              </div>
	              <!-- 숙소 예약정보 -->
	              <div class="col-md-12">
                    <h4 class="mb-4 mt-2 border-bottom pb-2">호텔 예약정보</h4>
                  </div>
                  <div class="row">
                  	<div class="mb-3 col-md-6">
                    	<label for="cardname" class="form-label">호텔이름
                    		<span class="text-danger">*</span>
                    	</label>
                    	<input type="text" class="form-control" id="hotelName" name="hotelName"
	                    	th:value="${hotelItem?.hotelName}" readonly>
                  	</div>
                  	<div class="mb-3 col-md-6">
                    	<label for="cardname" class="form-label">호텔주소
                    		<span class="text-danger">*</span>
                    	</label>
                    	<input type="text" class="form-control" id="hotelAddress1" name="hotelAddress1"
	                    	th:value="${hotelItem?.hotelAddress1}" readonly>
                  	</div>
                  </div>
                  <div class="row" th:each="list : ${bookingRoomList}">
                    <div class="mb-3 col-md-6">
	                    <label for="cardname" class="form-label">룸타입
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="roomType" name="roomType"
		                   	th:value="${list?.roomType}" readonly>
		            </div>
		            <div class="mb-3 col-md-6">
	                    <label for="cardname" class="form-label">금액
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="price" name="price"
		                   	th:value="${#numbers.formatInteger(list?.price, 0, 'COMMA')} + '원'" readonly>
		            </div>
                  </div>
                  <div class="row">
	                  <div class="mb-3 col-md-6">
	                    <label for="fname" class="form-label">체크인
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="checkInDate" name="checkInDate"
	                    	th:value="${#dates.format(bookingItem?.checkInDate, 'yyyy-MM-dd')}" readonly>
	                  </div>
	                  <div class="mb-3 col-md-6">
	                    <label for="email" class="form-label">체크아웃
	                    	<span class="text-danger">*</span>
	                    </label>
	                    <input type="text" class="form-control" id="checkOutDate" name="checkOutDate"
	                    	th:value="${#dates.format(bookingItem?.checkOutDate, 'yyyy-MM-dd')}" readonly>
	                  </div>
                  </div>
                 
                  <!-- payment details -->
                  <div class="col-md-12">
                    <h4 class="mb-4 mt-2 border-bottom pb-2">결제수단</h4>
                  </div>
                  <div class="col-md-12">
					<div class="d-flex flex-wrap mb-4">
						<div class="mb-3 col-md-6">
							<input type="radio" name="bkPayment" value="4"> 카카오페이
								<img src="/usr/v1/template/booking_page/rentkit-html/assets/images/self/Kakaopayment_icon.png" style="height: 20px; width: 48px;">
							<br>
							<input type="radio" name="bkPayment" value="3"> 신용카드/체크카드
								<img src="/usr/v1/template/booking_page/rentkit-html/assets/images/self/visa-icon.png" style="height: 30px; width: 30px;">
								<img src="/usr/v1/template/booking_page/rentkit-html/assets/images/self/mastercard-icon.png" style="height: 30px; width: 30px;">
								<img src="/usr/v1/template/booking_page/rentkit-html/assets/images/self/unionpay-icon.png" style="height: 30px; width: 30px;">
								<img src="/usr/v1/template/booking_page/rentkit-html/assets/images/self/jcb-icon.png" style="height: 30px; width: 30px;">
								<img src="/usr/v1/template/booking_page/rentkit-html/assets/images/self/american-icon.png" style="height: 30px; width: 30px;">
							<br>
							<!-- booking테이블의 boSeq 정보 bookingUpdate에 넘겨주기 -->
							<input type="hidden" name="bookingSeq" th:value="${bookingItem?.bookingSeq}">
						</div>
					</div>
				</div>
				<!-- 결제금액 -->
                <div class="col-md-12">
                  <h4 class="mb-4 mt-2 border-bottom pb-2">결제금액</h4>
                </div>
                  <div class="col-md-12">
                    <div class="d-flex justify-content-between align-items-center">
                    	<p class="mb-1 text-lg text-dark">
						  <span>합계 (세금 및 수수료 포함) : </span>
						  <span th:text="${#numbers.formatInteger(bookingItem?.totalPrice, 0, 'COMMA')} + '원'"></span>
						</p>
                      <div>
						<div class="mb-3 col-md-12" style="align-items: right;">
		                    <button type="submit" id="btnSubmit" class="btn btn-primary">
	                        	<i class="mdi mdi-lock me-2"></i>예약하기
	                        </button>
	                  	</div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- ======= footer ======= -->
	<div th:replace="~{usr/v1/infra/common/footer :: div}"></div>
	<!-- End footer -->
      
  </div>
  	<!-- scripts -->
  	<script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/owl.carousel/dist/owl.carousel.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/select2/dist/js/select2.full.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/select2/dist/js/select2.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/jquery-raty-js/lib/jquery.raty.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/quill/dist/quill.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/uppy/dist/uppy.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/litepicker/dist/litepicker.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/prismjs/prism.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/leaflet/dist/leaflet.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/magnific-popup/dist/jquery.magnific-popup.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/nouislider/dist/nouislider.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/wnumb/wNumb.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/simplebar/dist/simplebar.min.js"></script>
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/libs/apexcharts/dist/apexcharts.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.12/clipboard.min.js"></script>
    <script src="/usr/v1/js/commonUsr.js"></script>

    <!-- Theme JS -->
    <script src="/usr/v1/template/booking_page/rentkit-html/assets/js/theme.min.js"></script>
    
    <script type="text/javascript">
	    // 카카오페이 결제 팝업창 연결
	    $(function() {
	        $("#btn-pay-ready").click(function(e) {
	            // 아래 데이터 외에도 필요한 데이터를 원하는 대로 담고, Controller에서 @RequestBody로 받으면 됨
	            let data = {
	                name: '상품명',    // 카카오페이에 보낼 대표 상품명
	                totalPrice: 20000 // 총 결제금액
	            };
	          
	            $.ajax({
	                type: 'POST',
	                url: '/order/pay/ready',
	                data: JSON.stringify(data),
	                contentType: 'application/json',
	                success: function(response) {
	                location.href = response.next_redirect_pc_url;
	                },
	                error: function(xhr, status, error) {
	                    console.log("Request failed with status: " + status);
	                    console.log("Error: " + error);
	                }
	            });
	        });
	    });
	</script>
	<script type="text/javascript">
		document.getElementById("btnSubmit").onclick = function(){
			
			// price 필드에서 '원'과 쉼표를 제거하여 숫자만 남기도록 처리
	        var priceField = document.getElementById("price");
	        var priceValue = priceField.value;

	        // '원'과 쉼표 제거
	        var cleanedPrice = priceValue.replace(/[^\d]/g, '');  // 숫자만 남기기

	        // 수정된 값으로 price 필드 업데이트
	        priceField.value = cleanedPrice;

	        // 폼 제출
	        var form = document.forms[0];  // form을 선택
			
			form.action = "/v1/infra/usrhotel/bookingUpdt";
			form.submit();
		}
	</script>